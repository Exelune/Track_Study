# 오늘 배운것
유니티의 SMB(StateMachineBehaviour)에 대해 배웠다.

<br>

## 시작 시간
<img width="2560" height="1440" alt="image" src="https://github.com/user-attachments/assets/aab40634-c107-49be-8b97-c5910134b223" />
오후 5시 59분

<br>

## SMB(StateMachineBehaviour)
SMB는 MonoBehaviour과 달리 Animator의 상태 또는 서브 스테이트 머신에 붙는 스크립트이다.
주로 애니메이션 상태(Enter, Update, Exit)에 기반한 로직을 짤때 쓰이는 기능이다.

<br>

주요 함수로는

OnStateEnter - 이 상태로 들어오는 순간 1번 호출
``` Csharp
public override void OnStateEnter(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)
```

OnStateUpdate - 이 상태에 머무르는 동안 매 프레임 호출
``` Csharp
public override void OnStateUpdate(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)
```

OnStateExit - 이 상태에서 벗어나는 순간 1번 호출
``` Csharp
public override void OnStateExit(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)
```

OnStateMove - 프레임마다 Animator 정보가 갱신 되었을때에 호출 (Root Motion 전용)

OnStateIK - 프레임마다 IK 정보가 갱신 되었을때에 호출 (IK 전용)

OnStateMachineEnter / Exit - 서브 스테이트 머신에 들어갈때 / 나갈때 호출

<br>

SMB의 장점
- 애니메이션의 상태를 기반으로 작동하기에 조건체크를 외부 코드에서 매 프레임 할 필요가 없다.
- 비슷한 내용을 사용할 경우 재사용 가능
- Animation Event(클립에 종속적)보다 구조적이다.

<br>

SMB의 단점
- 너무 많이 넣을 경우에 디버깅이 힘들어진다.
- 애니메이션의 상태 구조에 너무 의존하는 구조가 될수 있다.
- 상태 이름, 구조가 바뀌면 SMB도 같이 수정해야 한다.
- 팀 프로젝트시에 꼬일수도 있다.

<br>

## 결론
SMB는 Animator의 상태에 붙여서 애니메이션의 상태에 기반하여 작동하는 스크립트이다. 

애니메이션의 상태에 타이밍에 맞추는 로직에는 사용하기 좋지만, 그렇지 않은 경우에는 오히려 복잡해지고 디버깅이 어려워져서 쓰지 않는게 좋다.

<br>

## 활용법
Attack 상태에 들어갔을때 공격범위의 HitBox를 활성화, 프레임마다 조금씩 HitBox가 범위에 맞춰서 움직이다가 Attack 상태에서 벗어날경우 HitBox를 비활성화 하는 기믹에 사용할수 있다.
죽었을때 공격에 피격당하지 않게 Collider를 비활성화 시킬수 있다.

<br>

## 끝낸 시간
<img width="2560" height="1440" alt="image" src="https://github.com/user-attachments/assets/e94caffe-7939-4b39-b66d-41752e4f8a14" />
오후 6시 48분

총합 51분
